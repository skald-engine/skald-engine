<!DOCTYPE html>
<html>
<head>
  <title></title>
  <script type="text/javascript" src="/build/lib/skald.min.js"></script>
</head>
<body>
  
  <h1>Shader</h1>

  <script id="shader" type="shader">
    precision mediump float;

    varying vec2 vTextureCoord;
    uniform sampler2D uSampler;
    uniform float time;

    void main(void) {
      gl_FragColor = texture2D(uSampler, vTextureCoord);
      gl_FragColor.a *= 0.1;
    }
  </script>

  <script>
    // Configuration ----------------------------------------------------------
    sk.scene({
      name: 'base',
      initialize: function() {
        this.background2 = new PIXI.Sprite()
        this.background2.texture = game.resources.get('scene2')
        this.addStatic(this.background2)

        
        this.background = new PIXI.Sprite()
        this.background.texture = game.resources.get('scene1')
        this.addStatic(this.background)

        this.uniforms = {
          time: {type:'f', value:0}
        }
        let code = document.getElementById('shader').innerHTML
        this.shader = new PIXI.AbstractFilter('', code, this.uniforms)
        this.background.filters = [this.shader]
      },

      update: function(delta) {
        this.shader.uniforms.time += delta
      }
    })

    // Game initialization ----------------------------------------------------
    const config = {
      display: {width: 1024, height: 576},
    }
    let game = new sk.Game(config)

    // Starting ---------------------------------------------------------------
    game.resources.addTexture('scene1', '../features/assets/textures/scene-morning.png')
    game.resources.addTexture('scene2', '../features/assets/textures/scene-evening.png')
    game.resources.load()
    game.addEventListener('resourcecomplete', () => {
      game.scenes.play('base')
    })

  </script>

</body>
</html>