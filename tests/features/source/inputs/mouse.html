<!DOCTYPE html>
<html>
<head>
  <title></title>
  <script type="text/javascript" src="/build/lib/skald.min.js"></script>
</head>
<body>
  
  <h1>Mouse Input</h1>

  <p>Keep the left mouse pressed to move, and right click to change the color.</p>

  <script>
    // Configuration ----------------------------------------------------------
    sk.entity({
      name: 'hero',
      display: 'animatedSprite',
      initialize: function() {
        this.display.configure({
          spriteSheet: game.resources.get('zombie'),
          position: {
            x: game.display.halfWidth,
            y: game.display.halfHeight
          },
          anchor: {x:0.5, y:0.5},
          scale: {x:0.4, y:0.4}
        })

      }
    })


    sk.scene({
      name: 'base',
      initialize: function() {
        this.hero = this.addEntity('hero')
      },

      update: function(delta) {
        let speed = 50
        this.hero.display.update(delta)

        if (game.mouse.isDown(sk.BUTTON.LEFT)) {
          let deltaX = game.mouse.x - this.hero.display.x
          let deltaY = game.mouse.y - this.hero.display.y

          let dirX = Math.abs(deltaX)/deltaX
          let dirY = Math.abs(deltaY)/deltaY

          if (Math.abs(deltaX) > 10) {
            this.hero.display.x += dirX*speed*delta
          }
          if (Math.abs(deltaY) > 10) {
            this.hero.display.y += dirY*speed*delta
          }

          if (dirX < 0) {
            this.hero.display.scale.x = -Math.abs(this.hero.display.scale.x)
          } else {
            this.hero.display.scale.x = Math.abs(this.hero.display.scale.x)
          }
        }
        if (game.mouse.isPressed(sk.BUTTON.RIGHT)) {
          if (this.hero.display.tint === 0xFFFFFF) {
            this.hero.display.tint = 0xFF0000
          } else {
            this.hero.display.tint = 0xFFFFFF
          }
        }
      }
    })

    // Game initialization ----------------------------------------------------
    let game = new sk.Game({
      startScene: 'base',
      resources: {basePath: '../../assets/'},
      display: {width: 400, height: 400},
      logger: {level: 'trace'},
      manifest: [
        {id: 'zombie', type: 'spriteSheet', url: 'spritesheets/zombie_walking.json'},
      ]
    })
  </script>

</body>
</html>