<!DOCTYPE html>
<html>
<head>
  <title></title>
  <script type="text/javascript" src="/build/lib/skald.min.js"></script>
</head>
<body>
  
  <h1>Event Sheets test</h1>

  <p>Left click to dispatch custom event.</p>

  <ul>
    <li>Updates: <span id="updates">0</span></li>
    <li>Clicks: <span id="clicks">0</span></li>
  </ul>

  <script>
    // Configuration ----------------------------------------------------------

    sk.entity({
      name: 'hero',
      display: 'animatedSprite',
      initialize: function() {
        this.display.configure({
          spriteSheet: game.resources.get('zombie'),
          position: {
            x: game.display.halfWidth,
            y: game.display.halfHeight
          },
          anchor: {x:0.5, y:0.5},
          scale: {x:0.4, y:0.4}
        })
      }
    })

    sk.eventSheet({
      name: 'colorize',
      initialize: function() {
        this.updates = 0
        this.clicks = 0
        this.elUpdates = document.getElementById('updates')
        this.elClicks = document.getElementById('clicks')
      },

      events: {
        'custom': function() {
          this.elClicks.innerHTML = ++this.clicks
        },
        'update': function() {
          this.elUpdates.innerHTML = ++this.updates
        }
      }
    })

    sk.scene({
      name: 'base',
      eventSheets: ['colorize'],
      initialize: function() {
        this.hero = this.addEntity('hero')
      },

      update: function(delta) {
        this.hero.display.update(delta)

        if (this.game.mouse.isPressed(sk.BUTTON.LEFT)) {
          this.game.events.dispatch('custom')
        }
      }
    })

    // Game initialization ----------------------------------------------------
    const config = {
      resources: {basePath: '../../assets/'},
      display: {width: 400, height: 400},
      logger: {level: 'trace'}
    }
    const manifest = [
      {id: 'zombie', type: 'spriteSheet', url: 'spritesheets/zombie_walking.json'},
    ]
    let game = new sk.Game(config, manifest)

    // Starting ---------------------------------------------------------------
    game.addEventListener('resourcecomplete', () => {
      game.scenes.play('base')
    })

  </script>

</body>
</html>